<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kai Store Official - Top Up Games</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Global Styles & Variables */
        :root {
            --primary-bg-dark: #120A2C; /* Deep purple-black */
            --secondary-bg-dark: #1F1545; /* Slightly lighter, main container */
            --tertiary-bg-dark: #2F2460; /* Card backgrounds, richer purple */
            --text-color-dark: #E0E0FF; /* Soft white/lavender text */
            --heading-color-dark: #D4A7FF; /* Brighter purple for headings */
            --accent-color-purple: #B266FF; /* Main interactive purple */
            --accent-color-light-purple: #E0BFFF; /* Lighter for hover/focus */
            --border-color-dark: #503E8A; /* Darker purple border */
            --input-bg-dark: #3F3277; /* Input background */
            --button-bg-dark: var(--accent-color-purple);
            --button-hover-dark: var(--accent-color-light-purple);
            --card-bg-dark: var(--tertiary-bg-dark);

            /* Light Mode Variables (Optional, can be fully customized) */
            --primary-bg-light: #F0F2F5;
            --secondary-bg-light: #FFFFFF;
            --tertiary-bg-light: #FAFAFF;
            --text-color-light: #333333;
            --heading-color-light: #6A0DAD; /* Dark purple */
            --border-color-light: #D0D0E0;
            --input-bg-light: #E8E8FF;
            --button-bg-light: var(--accent-color-purple);
            --button-hover-light: var(--accent-color-light-purple);
            --card-bg-light: var(--secondary-bg-light);
        }

        /* Base styles */
        body {
            font-family: var(--font-family-primary);
            margin: 0;
            padding: 0;
            background-color: var(--primary-bg-dark);
            color: var(--text-color-dark);
            transition: background-color 0.6s ease-in-out, color 0.6s ease-in-out;
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Universal smooth transition for theme change */
        .transition-animate * {
            transition: background-color 0.6s ease-in-out, color 0.6s ease-in-out, 
                        border-color 0.6s ease-in-out, box-shadow 0.6s ease-in-out,
                        filter 0.6s ease-in-out, transform 0.3s ease-out, opacity 0.3s ease-out;
        }

        /* Light mode toggle */
        body.light-mode {
            background-color: var(--primary-bg-light);
            color: var(--text-color-light);
        }
        body.light-mode .header,
        body.light-mode .navbar,
        body.light-mode .footer {
            background-color: var(--secondary-bg-light);
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        body.light-mode .container,
        body.light-mode .card,
        body.light-mode .product-item,
        body.light-mode .payment-option {
            background-color: var(--card-bg-light);
            border: 1px solid var(--border-color-light);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        body.light-mode input[type="text"],
        body.light-mode input[type="number"],
        body.light-mode input[type="password"],
        body.light-mode input[type="file"],
        body.light-mode select {
            background-color: var(--input-bg-light);
            border: 1px solid var(--border-color-light);
            color: var(--text-color-light);
        }
        body.light-mode input[type="text"]::placeholder,
        body.light-mode input[type="number"]::placeholder,
        body.light-mode input[type="password"]::placeholder {
            color: #888;
        }
        body.light-mode button,
        body.light-mode .btn {
            background-color: var(--button-bg-light);
            color: white;
        }
        body.light-mode button:hover,
        body.light-mode .btn:hover {
            background-color: var(--button-hover-light);
        }
        body.light-mode .payment-option.selected,
        body.light-mode .product-item.selected {
            border-color: var(--accent-color-purple);
            box-shadow: 0 0 12px rgba(155, 89, 182, 0.4);
            background-color: #f0e6f7;
        }
        body.light-mode .login-box {
            background-color: rgba(255,255,255, 0.9);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color-light);
        }
        body.light-mode .login-box::before {
            filter: blur(30px) brightness(1.2);
            opacity: 0.05;
        }
        body.light-mode .login-box h2 {
            text-shadow: none;
        }
        body.light-mode .discount-message.success {
            color: #28a745;
        }
        body.light-mode .discount-message.error {
            color: #dc3545;
        }
        body.light-mode .password-toggle {
            color: #666;
        }
        body.light-mode .product-item p,
        body.light-mode .payment-option p,
        body.light-mode label {
            color: var(--text-color-light);
        }
        body.light-mode h2 {
            color: var(--heading-color-light);
            border-bottom-color: var(--heading-color-light);
            text-shadow: none;
        }
        body.light-mode .summary-item span:last-child,
        body.light-mode .summary-total span:last-child {
            color: var(--heading-color-light);
            text-shadow: none;
        }
        body.light-mode .modal-content h3 {
            color: var(--heading-color-light);
            text-shadow: none;
        }
        body.light-mode .modal-content strong {
            color: var(--heading-color-light);
            text-shadow: none;
        }
        body.light-mode .contact-button-group .contact-button {
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color-light);
        }
        body.light-mode .contact-button-group .contact-button:hover {
            background-color: var(--input-bg-light);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        body.light-mode .contact-button-group .contact-button .icon-container {
            background-color: var(--input-bg-light);
        }


        /* Header */
        .header {
            background-color: var(--secondary-bg-dark);
            color: var(--text-color-dark);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            position: sticky;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            height: var(--header-height);
            box-sizing: border-box;
            border-bottom: 1px solid var(--border-color-dark);
        }

        .header .logo {
            font-family: var(--font-family-secondary);
            font-size: 2.2em;
            font-weight: 700;
            color: var(--heading-color-dark);
            text-decoration: none;
            display: flex;
            align-items: center;
            letter-spacing: -0.5px;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }
        .header .logo img {
            height: 45px;
            margin-right: 12px;
            border-radius: 8px;
        }

        /* Desktop Nav (hidden on mobile) */
        .navbar {
            display: flex;
            align-items: center;
            flex-grow: 1;
            justify-content: flex-end;
        }
        .navbar ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center;
        }

        .navbar ul li {
            margin-left: 30px;
        }

        .navbar ul li a {
            color: var(--text-color-dark);
            text-decoration: none;
            font-weight: 600;
            font-size: 1.05em;
            position: relative;
            padding-bottom: 5px;
            transition: color 0.3s ease;
        }

        .navbar ul li a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0%;
            height: 2px;
            background-color: var(--accent-color-light-purple);
            transition: width 0.3s ease-out, left 0.3s ease-out;
        }

        .navbar ul li a:hover {
            color: var(--accent-color-light-purple);
        }
        .navbar ul li a:hover::after {
            width: 100%;
            left: 0%;
        }

        .cart-icon {
            font-size: 1.6em;
            color: var(--text-color-dark);
            margin-left: 25px;
            cursor: pointer;
            position: relative;
            transition: color 0.3s ease, transform 0.2s ease;
        }
        .cart-icon:hover {
            color: var(--accent-color-light-purple);
            transform: translateY(-2px);
        }

        .cart-icon .cart-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            padding: 3px 7px;
            font-size: 0.65em;
            font-weight: bold;
            display: none;
            min-width: 15px;
            text-align: center;
            box-shadow: 0 0 5px rgba(231, 76, 60, 0.5);
        }

        /* Desktop Options (3 dots menu) */
        .desktop-options {
            display: flex;
            align-items: center;
            position: relative;
            margin-left: 20px;
        }

        .desktop-dots {
            display: block;
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-color-dark);
            line-height: 0.5;
            padding: 5px;
            border-radius: 50%;
            transition: color 0.3s ease, background-color 0.3s ease;
        }
        .desktop-dots:hover {
            color: var(--accent-color-purple);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            background-color: var(--secondary-bg-dark);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            z-index: 1001;
            min-width: 180px;
            padding: 10px 0;
            border: 1px solid var(--border-color-dark);
            opacity: 0;
            transform: translateY(-10px);
            animation: fadeInScale 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        .dropdown-menu.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        .dropdown-menu button {
            background: none;
            border: none;
            color: var(--text-color-dark);
            padding: 12px 20px;
            width: 100%;
            text-align: left;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease;
            box-shadow: none;
            text-transform: none;
        }
        .dropdown-menu button:hover {
            background-color: var(--card-bg-dark);
            color: var(--accent-color-light-purple);
            transform: none;
            filter: none;
        }

        /* Funny Toggles Styling */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            position: absolute;
            top: 18px; /* Adjusted position */
            right: 15px; /* Adjusted position */
            z-index: 1002;
        }

        .theme-switch {
            display: inline-block;
            height: 34px;
            padding: 0;
            width: 60px;
            border-radius: 34px;
            background-color: var(--input-bg-dark); /* Using input background for base */
            position: relative;
            cursor: pointer;
            transition: background-color 0.4s ease;
            border: 2px solid var(--border-color-dark);
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }
        body.light-mode .theme-switch {
            background-color: var(--input-bg-light);
            border-color: var(--border-color-light);
        }

        .theme-switch::after {
            content: "";
            position: absolute;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-color-purple), var(--accent-color-light-purple)); /* Gradient for toggle knob */
            top: 4px;
            left: 4px;
            transition: transform 0.3s ease, background 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        body.light-mode .theme-switch::after {
            background: linear-gradient(135deg, #FFFFFF, #E0E0E0); /* White gradient for light mode knob */
            transform: translateX(26px);
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-switch input:checked + .theme-switch::after {
            transform: translateX(26px);
        }


        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 30px;
            background-color: var(--secondary-bg-dark);
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            border: 1px solid var(--border-color-dark);
            /* Glassmorphism/modern computer feel */
            backdrop-filter: blur(5px);
            background-color: rgba(31,21,69, 0.85);
        }
        /* Update RGB for JS theme toggle */
        body.light-mode .container { background-color: rgba(255,255,255,0.9); }


        .main-content {
            flex: 3;
            min-width: 650px;
        }

        .sidebar {
            flex: 1;
            min-width: 320px;
            background-color: var(--card-bg-dark);
            border-radius: 10px;
            padding: 25px;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.25);
            border: 1px solid var(--border-color-dark);
            /* Glassmorphism for sidebar */
            backdrop-filter: blur(3px);
            background-color: rgba(47,36,96, 0.8);
        }
        /* Update RGB for JS theme toggle */
        body.light-mode .sidebar { background-color: rgba(253,253,255, 0.9); }


        .card {
            background-color: var(--card-bg-dark);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color-dark);
            overflow: hidden;
            /* Glassmorphism for cards */
            backdrop-filter: blur(3px);
            background-color: rgba(47,36,96, 0.8);
        }
        .card:last-child {
            margin-bottom: 0;
        }

        h2 {
            color: var(--heading-color-dark);
            font-family: var(--font-family-secondary);
            font-size: 2em;
            margin-top: 0;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--accent-color-purple);
            padding-bottom: 12px;
            letter-spacing: 0.5px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
        }

        .game-selection {
            display: flex;
            gap: 20px;
            margin-bottom: 35px;
            justify-content: center;
        }
        .game-selection img {
            width: 130px;
            height: 130px;
            border-radius: 18px;
            object-fit: cover;
            cursor: pointer;
            border: 4px solid transparent;
            transition: border-color 0.4s ease, transform 0.25s ease, box-shadow 0.4s ease, filter 0.4s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            filter: brightness(0.7) grayscale(0.7);
        }
        .game-selection img:hover {
            border-color: var(--accent-color-purple);
            transform: translateY(-8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.6);
            filter: brightness(1) grayscale(0);
        }
        .game-selection img.selected {
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 0 25px var(--accent-color-light-purple), 0 8px 25px rgba(0,0,0,0.6);
            transform: translateY(-5px);
            filter: brightness(1.1) grayscale(0);
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color-dark);
            font-size: 1.05em;
        }

        input[type="text"],
        input[type="number"],
        input[type="password"],
        select {
            width: calc(100% - 28px);
            padding: 16px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color-dark);
            border-radius: 10px;
            background-color: var(--input-bg-dark);
            color: var(--text-color-dark);
            font-size: 1.05em;
            box-sizing: border-box;
            transition: border-color 0.4s ease, box-shadow 0.4s ease, background-color 0.4s ease;
            box-shadow: inset 0 1px 5px rgba(0,0,0,0.2);
        }
        input[type="text"]::placeholder,
        input[type="number"]::placeholder,
        input[type="password"]::placeholder {
            color: #A0A0A0;
            font-style: italic;
        }
        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="password"]:focus,
        select:focus {
            outline: none;
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 0 15px rgba(199, 143, 255, 0.6), inset 0 1px 8px rgba(0,0,0,0.3);
            background-color: #3B2E70;
        }

        /* Specific input group for User ID & Server ID */
        .user-id-inputs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .user-id-inputs .input-group {
            flex: 1;
            min-width: 140px;
            margin-bottom: 0;
        }
        .user-id-inputs .input-group label {
            margin-bottom: 8px;
        }
        .user-id-inputs .input-group input {
            width: calc(100% - 28px);
            margin-bottom: 0;
        }
        /* Error message for User ID / Server ID */
        .input-error-message {
            color: #FF6347;
            font-size: 0.9em;
            margin-top: -15px;
            margin-bottom: 15px;
            display: none;
        }
        .input-error-message.active {
            display: block;
        }


        /* File input styling */
        input[type="file"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color-dark);
            border-radius: 10px;
            background-color: var(--input-bg-dark);
            color: var(--text-color-dark);
            font-size: 1em;
            cursor: pointer;
            box-sizing: border-box;
            transition: border-color 0.4s ease, box-shadow 0.4s ease, background-color 0.4s ease;
            box-shadow: inset 0 1px 5px rgba(0,0,0,0.2);
        }
        input[type="file"]:focus {
            outline: none;
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 0 15px rgba(199, 143, 255, 0.6), inset 0 1px 8px rgba(0,0,0,0.3);
            background-color: #3B2E70;
        }
        input[type="file"]::file-selector-button {
            background-color: var(--accent-color-purple);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            margin-right: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        input[type="file"]::file-selector-button:hover {
            background-color: var(--accent-color-light-purple);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        /* Live image preview for file input */
        .image-preview-container {
            margin-top: 15px;
            text-align: center;
        }
        .image-preview-container img {
            max-width: 150px;
            height: auto;
            border-radius: 8px;
            border: 2px solid var(--border-color-dark);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .image-preview-container p {
            font-size: 0.9em;
            color: var(--text-color-dark);
            margin-top: 10px;
        }


        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 18px;
            margin-top: 25px;
        }

        .product-item {
            background-color: var(--card-bg-dark);
            border: 2px solid var(--border-color-dark);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.25s ease, border-color 0.4s ease, box-shadow 0.4s ease, background-color 0.4s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .product-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(178, 102, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        .product-item:hover::before {
            opacity: 1;
        }

        .product-item:hover {
            transform: translateY(-8px);
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        }

        .product-item.selected {
            border-color: var(--accent-color-purple);
            box-shadow: 0 0 25px rgba(178, 102, 255, 0.7), 0 8px 25px rgba(0,0,0,0.6);
            background-color: #3A2C75;
            transform: translateY(-4px);
        }
        .product-item.selected::before {
             opacity: 1;
             background: radial-gradient(circle at 50% 50%, rgba(178, 102, 255, 0.25) 0%, transparent 70%);
        }


        .product-item p {
            margin: 6px 0;
            font-size: 1.15em;
            font-weight: 600;
            color: var(--text-color-dark);
            z-index: 1;
        }
        .product-item .price {
            font-size: 1.3em;
            color: var(--accent-color-purple);
            font-weight: 700;
            letter-spacing: 0.5px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
            z-index: 1;
        }
        .product-item img.diamond-icon {
            height: 30px;
            vertical-align: middle;
            margin-right: 8px;
            filter: drop-shadow(0 0 5px rgba(178, 102, 255, 0.4));
            z-index: 1;
        }

        .payment-options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 18px;
            margin-top: 25px;
        }

        .payment-option {
            background-color: var(--card-bg-dark);
            border: 2px solid var(--border-color-dark);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.25s ease, border-color 0.4s ease, box-shadow 0.4s ease, background-color 0.4s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100px;
        }

        .payment-option:hover {
            transform: translateY(-8px);
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        }

        .payment-option.selected {
            border-color: var(--accent-color-purple);
            box-shadow: 0 0 25px rgba(178, 102, 255, 0.7), 0 8px 25px rgba(0,0,0,0.6);
            background-color: #3A2C75;
            transform: translateY(-4px);
        }

        .payment-option img {
            max-width: 90px;
            height: auto;
            margin-bottom: 12px;
            border-radius: 8px;
            filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
        }
        .payment-option.selected img {
            filter: drop-shadow(0 0 8px var(--accent-color-light-purple));
        }

        .payment-option p {
            margin: 0;
            font-weight: 600;
            font-size: 1em;
            color: var(--text-color-dark);
        }

        button {
            display: block;
            width: 100%;
            padding: 18px;
            background-color: var(--button-bg-dark);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease, filter 0.3s ease;
            box-shadow: 0 6px 20px rgba(178, 102, 255, 0.4);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        button:hover {
            background-color: var(--button-hover-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(178, 102, 255, 0.5);
            filter: brightness(1.1);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 3px 10px rgba(178, 102, 255, 0.3);
        }

        /* Order Summary / Sidebar */
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.15em;
        }
        .summary-item span:first-child {
            font-weight: 600;
            color: var(--text-color-dark);
        }
        .summary-item span:last-child {
            color: var(--accent-color-purple);
            font-weight: 700;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
        }
        .summary-total {
            border-top: 1px dashed var(--border-color-dark);
            padding-top: 20px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            font-size: 1.4em;
            font-weight: 700;
        }
        .summary-total span:last-child {
            color: var(--heading-color-dark);
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }

        .discount-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px dashed var(--border-color-dark);
        }

        .discount-input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }
        .discount-input-group input {
            flex-grow: 1;
            margin-bottom: 0;
            padding: 12px;
            font-size: 1em;
        }
        .discount-input-group button {
            width: auto;
            padding: 10px 18px;
            font-size: 0.95em;
            min-width: 110px;
        }
        .discount-message {
            font-size: 0.95em;
            margin-top: 8px;
            text-align: center;
            height: 1.3em;
            font-weight: 500;
        }
        .discount-message.success {
            color: #3cb371;
        }
        .discount-message.error {
            color: #ff6347;
        }

        /* Customer Service & Confirmation */
        .contact-info p {
            margin: 10px 0;
            font-size: 1.05em;
        }
        .contact-info a {
            color: var(--accent-color-purple);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        .contact-info a:hover {
            color: var(--accent-color-light-purple);
            text-decoration: underline;
        }

        .cs-contact-method img {
            width: 35px;
            height: 35px;
            margin-right: 15px;
            border-radius: 50%;
            filter: drop-shadow(0 0 5px rgba(0,0,0,0.3));
        }

        .qris-code {
            text-align: center;
            margin-top: 25px;
        }
        .qris-code img {
            max-width: 280px;
            width: 100%;
            height: auto;
            border-radius: 10px;
            border: 2px solid var(--border-color-dark);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        /* Footer */
        .footer {
            background-color: var(--secondary-bg-dark);
            color: var(--text-color-dark);
            text-align: center;
            padding: 25px;
            margin-top: 40px;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.4);
            border-top: 1px solid var(--border-color-dark);
        }
        .footer p {
            margin: 0;
            font-size: 0.95em;
            line-height: 1.8;
        }
        .footer a {
            color: var(--accent-color-purple);
            text-decoration: none;
            font-weight: 600;
        }
        .footer a:hover {
            text-decoration: underline;
        }

        /* Login Page */
        /* Background animation for login page */
        body.login-body {
            background: linear-gradient(135deg, #0A0A1F 0%, #1A0F3A 100%);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
            z-index: 1; /* Ensure background is behind login box particles */
        }
        /* Stars/Particles for login background */
        body.login-body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"><rect width="100%" height="100%" fill="transparent"/><circle cx="10%" cy="20%" r="2" fill="rgba(255,255,255,0.8)"/><circle cx="80%" cy="90%" r="1.5" fill="rgba(255,255,255,0.7)"/><circle cx="30%" cy="70%" r="2.5" fill="rgba(255,255,255,0.9)"/><circle cx="60%" cy="40%" r="1" fill="rgba(255,255,255,0.6)"/></svg>');
            background-size: 500px 500px;
            animation: moveStars 100s linear infinite;
        }
        @keyframes moveStars {
            from { background-position: 0 0; }
            to { background-position: 500px 500px; }
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: absolute; /* Changed to absolute to sit over animated background */
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 10; /* Above stars */
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        .login-box {
            background-color: rgba(47,36,96, 0.7); /* More transparent for glassmorphism */
            backdrop-filter: blur(10px); /* Stronger blur for glass effect */
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.8);
            width: 100%;
            max-width: 450px;
            text-align: center;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(178, 102, 255, 0.4); /* Subtle purple border */
            overflow: hidden;
        }
        /* Animated border glow */
        .login-box::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background: linear-gradient(45deg, #B266FF, #E0BFFF, #B266FF);
            background-size: 200% 200%;
            animation: borderGlow 5s ease-in-out infinite alternate;
            filter: blur(10px);
            z-index: -1;
            border-radius: 20px; /* Match login box */
            opacity: 0.6;
        }
        @keyframes borderGlow {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        .login-box h2 {
            color: var(--heading-color-dark);
            margin-bottom: 40px;
            font-size: 2.6em;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.6);
            letter-spacing: -1px;
            font-weight: 700;
        }
        .login-box .input-group {
            margin-bottom: 25px;
            text-align: left;
            position: relative;
            display: flex;
            align-items: center;
            background-color: var(--input-bg-dark);
            border-radius: 10px;
            border: 1px solid var(--border-color-dark);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        .login-box .input-group:focus-within {
            border-color: var(--accent-color-light-purple);
            box-shadow: 0 0 15px rgba(199, 143, 255, 0.6), inset 0 2px 8px rgba(0,0,0,0.3);
        }
        .login-box .input-group i {
            color: var(--text-color-dark);
            font-size: 1.2em;
            padding: 0 15px;
            transition: color 0.3s ease;
        }
        .login-box .input-group:focus-within i {
            color: var(--accent-color-light-purple);
        }
        .login-box label {
            display: none;
        }
        .login-box input[type="text"],
        .login-box input[type="password"] {
            flex-grow: 1;
            padding: 16px 0;
            margin: 0;
            border: none;
            background: none;
            color: var(--text-color-dark);
            font-size: 1.1em;
            box-sizing: border-box;
        }
        .login-box input[type="text"]:focus,
        .login-box input[type="password"]:focus {
            outline: none;
            background: none;
        }

        .password-toggle {
            position: static;
            transform: none;
            background: none;
            border: none;
            color: var(--text-color-dark);
            cursor: pointer;
            font-size: 1.2em;
            padding: 0 15px;
            transition: color 0.3s ease;
        }
        .password-toggle:hover {
            color: var(--accent-color-purple);
        }

        /* Checkbox & Forgot Password */
        .options-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            font-size: 0.95em;
        }
        .options-group input[type="checkbox"] {
            margin-right: 8px;
            accent-color: var(--accent-color-purple);
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        .options-group a {
            color: var(--accent-color-purple);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .options-group a:hover {
            color: var(--accent-color-light-purple);
            text-decoration: underline;
        }

        .login-box button {
            margin-top: 20px;
            padding: 18px;
            font-size: 1.4em;
            letter-spacing: 2px;
            box-shadow: 0 8px 30px rgba(178, 102, 255, 0.5);
            border-radius: 12px;
        }
        .login-box .error-message {
            color: #FF6347;
            margin-top: 18px;
            font-size: 1em;
            display: none;
            animation: shake 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
            font-weight: 500;
        }
        .register-link {
            margin-top: 25px;
            font-size: 1em;
            color: var(--text-color-dark);
        }
        .register-link a {
            color: var(--accent-color-purple);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        .register-link a:hover {
            color: var(--accent-color-light-purple);
            text-decoration: underline;
        }

        /* How to Topup Section */
        .how-to-topup-section {
            background-color: var(--secondary-bg-dark);
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            padding: 30px;
            margin-top: 40px;
            border: 1px solid var(--border-color-dark);
            backdrop-filter: blur(5px);
            background-color: rgba(31,21,69, 0.85);
        }
        .how-to-topup-section h2 {
            text-align: center;
        }
        .how-to-topup-list {
            list-style: none;
            padding: 0;
            margin-top: 30px;
        }
        .how-to-topup-list li {
            background-color: var(--card-bg-dark);
            border: 1px solid var(--border-color-dark);
            border-radius: 8px;
            padding: 20px 25px;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .how-to-topup-list li:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .how-to-topup-list li .step-number {
            font-family: var(--font-family-secondary);
            font-size: 1.8em;
            font-weight: 700;
            color: var(--accent-color-light-purple);
            background-color: rgba(178, 102, 255, 0.2);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
        }
        .how-to-topup-list li .step-content {
            flex-grow: 1;
            text-align: left;
        }
        .how-to-topup-list li .step-content h4 {
            color: var(--text-color-dark);
            font-size: 1.2em;
            margin: 0 0 8px 0;
        }
        .how-to-topup-list li .step-content p {
            color: var(--text-color-dark);
            font-size: 0.95em;
            margin: 0;
        }


        /* Desktop specific: Burger menu hidden */
        .header .nav-toggle {
            display: none;
        }
        .header .navbar {
            display: flex;
        }
        .header .desktop-options {
            display: flex;
        }
        /* Hide mobile-only menu items on desktop */
        .mobile-only-menu-item {
            display: none !important;
        }

        /* Funny Toggles Styling (Override previous .theme-switch-wrapper) */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            position: absolute; /* Kept absolute for header positioning */
            top: 18px; /* Adjusted position */
            right: 15px; /* Adjusted position */
            z-index: 1002;
        }

        .theme-switch {
            display: inline-block;
            height: 34px;
            padding: 0;
            width: 60px;
            border-radius: 34px;
            background-color: var(--input-bg-dark); /* Using input background for base */
            position: relative;
            cursor: pointer;
            transition: background-color 0.4s ease;
            border: 2px solid var(--border-color-dark);
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }
        body.light-mode .theme-switch {
            background-color: var(--input-bg-light);
            border-color: var(--border-color-light);
        }

        .theme-switch::after {
            content: "";
            position: absolute;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-color-purple), var(--accent-color-light-purple)); /* Gradient for toggle knob */
            top: 4px;
            left: 4px;
            transition: transform 0.3s ease, background 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        body.light-mode .theme-switch::after {
            background: linear-gradient(135deg, #FFFFFF, #E0E0E0); /* White gradient for light mode knob */
            transform: translateX(26px);
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-switch input:checked + .theme-switch::after {
            transform: translateX(26px);
        }
        /* End Funny Toggles Styling */


        /* Contact Buttons Section */
        .contact-button-section {
            background-color: var(--primary-bg-dark); /* Use darker background to stand out */
            padding: 50px 20px;
            text-align: center;
            margin-top: 40px;
            border-top: 1px solid var(--border-color-dark);
            box-shadow: inset 0 5px 20px rgba(0,0,0,0.2);
        }
        .contact-button-section h2 {
            color: var(--heading-color-dark);
            font-size: 2.5em;
            margin-bottom: 40px;
            text-shadow: 0 0 10px rgba(255,255,255,0.2);
            border-bottom: 2px solid var(--accent-color-purple);
            padding-bottom: 15px;
            display: inline-block; /* Adjust border to text width */
        }
        .contact-button-group {
            display: flex;
            justify-content: center;
            gap: 30px; /* Space between buttons */
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .contact-button {
            background-color: var(--secondary-bg-dark);
            border: 1px solid var(--border-color-dark);
            border-radius: 15px;
            padding: 25px;
            text-decoration: none;
            color: var(--text-color-dark);
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 150px; /* Fixed width for button */
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            text-shadow: 0 0 5px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(3px); /* Glass effect */
            background-color: rgba(31,21,69, 0.85); /* Semi-transparent */
        }
        .contact-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 0%, rgba(255,255,255,0.05) 0%, transparent 70%);
            transition: transform 0.5s ease;
        }
        .contact-button:hover::before {
            transform: scale(1.5);
        }

        .contact-button:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            border-color: var(--accent-color-purple);
            color: var(--accent-color-light-purple);
            background-color: rgba(47,36,96, 0.9); /* Slightly more opaque on hover */
        }

        .contact-button .icon-container {
            width: 80px;
            height: 80px;
            background-color: var(--tertiary-bg-dark); /* Match card background */
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3), 0 2px 5px rgba(0,0,0,0.2);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .contact-button:hover .icon-container {
            background-color: var(--accent-color-purple); /* Icon background changes on hover */
            box-shadow: inset 0 0 10px rgba(0,0,0,0.4), 0 0 15px rgba(255,255,255,0.3);
        }

        .contact-button .icon-container i {
            font-size: 3em;
            color: var(--heading-color-dark); /* White for icon */
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.2));
            transition: color 0.3s ease, filter 0.3s ease;
        }
        .contact-button.whatsapp-button .icon-container i { color: #25D366; filter: drop-shadow(0 0 8px rgba(37, 211, 102, 0.5));}
        .contact-button.instagram-button .icon-container i { color: #E1306C; filter: drop-shadow(0 0 8px rgba(225, 48, 108, 0.5));}
        .contact-button.email-button .icon-container i { color: #007BFF; filter: drop-shadow(0 0 8px rgba(0, 123, 255, 0.5));}

        .contact-button:hover.whatsapp-button .icon-container i { color: white; filter: drop-shadow(0 0 10px rgba(255,255,255,0.7)); }
        .contact-button:hover.instagram-button .icon-container i { color: white; filter: drop-shadow(0 0 10px rgba(255,255,255,0.7)); }
        .contact-button:hover.email-button .icon-container i { color: white; filter: drop-shadow(0 0 10px rgba(255,255,255,0.7)); }


        /* Mobile Responsive */
        @media (max-width: 900px) {
            .container {
                flex-direction: column;
                margin: 20px auto;
                padding: 20px;
                gap: 25px;
            }
            .main-content, .sidebar {
                min-width: unset;
                width: 100%;
            }
            .main-content {
                order: 2;
            }
            .sidebar {
                order: 1;
            }
            .card {
                padding: 25px;
            }
            h2 {
                font-size: 1.6em;
                margin-bottom: 20px;
            }
            .game-selection img {
                width: 100px;
                height: 100px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            }
            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 12px;
            }
            .product-item {
                padding: 15px;
                border-radius: 10px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            }
            .product-item p {
                font-size: 1em;
            }
            .product-item .price {
                font-size: 1.1em;
            }
            .product-item img.diamond-icon {
                height: 22px;
            }
            .payment-options-grid {
                grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
                gap: 12px;
            }
            .payment-option {
                padding: 15px;
                border-radius: 10px;
            }
            .payment-option img {
                max-width: 70px;
            }
            .payment-option p {
                font-size: 0.85em;
            }
            button {
                padding: 14px;
                font-size: 1.1em;
            }
            .summary-item {
                font-size: 1em;
            }
            .summary-total {
                font-size: 1.2em;
            }
            /* User ID inputs responsive */
            .user-id-inputs {
                flex-direction: column;
                gap: 0;
                margin-bottom: 0;
            }
            .user-id-inputs .input-group {
                min-width: unset;
                width: 100%;
                margin-bottom: 25px;
            }
            .user-id-inputs .input-group:last-child {
                margin-bottom: 0;
            }
            /* Adjust error message for mobile */
            .input-error-message {
                margin-top: -20px;
            }
            /* Contact Buttons Section */
            .contact-button-section {
                padding: 30px 15px;
            }
            .contact-button-section h2 {
                font-size: 2em;
            }
            .contact-button-group {
                gap: 20px;
            }
            .contact-button {
                width: 120px;
                padding: 20px;
            }
            .contact-button .icon-container {
                width: 60px;
                height: 60px;
                margin-bottom: 10px;
            }
            .contact-button .icon-container i {
                font-size: 2.5em;
            }
            .contact-button span {
                font-size: 0.9em;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }
            .header .logo {
                font-size: 1.8em;
                margin-right: auto;
            }
            .header .logo img {
                height: 35px;
            }
            .nav-toggle {
                display: block;
            }
            .header .desktop-options {
                display: none;
            }
            .header .navbar {
                display: none;
                flex-direction: column;
                width: 100%;
                position: absolute;
                top: var(--header-height);
                left: 0;
                background-color: var(--secondary-bg-dark);
                box-shadow: 0 5px 15px rgba(0,0,0,0.4);
                padding-bottom: 15px;
                border-bottom-left-radius: 10px;
                border-bottom-right-radius: 10px;
            }
            .navbar.active {
                display: flex;
            }
            .navbar ul {
                flex-direction: column;
                width: 100%;
                align-items: center;
            }
            .navbar ul li {
                margin: 12px 0;
                width: 90%;
                text-align: center;
            }
            .navbar ul li a {
                padding: 10px 0;
                display: block;
                font-size: 1.05em;
                border-radius: 8px;
                transition: background-color 0.2s ease, color 0.2s ease;
            }
            .navbar ul li a:hover {
                background-color: var(--card-bg-dark);
            }
            .navbar ul li a::after {
                display: none;
            }
            .cart-icon {
                margin-left: 10px;
                font-size: 1.4em;
            }
            /* Show mobile-only menu items on mobile */
            .mobile-only-menu-item {
                display: block !important;
                width: 90%;
            }
            .mobile-only-menu-item button {
                display: block !important;
                color: var(--text-color-dark);
                text-transform: none;
                box-shadow: none;
                transition: background-color 0.2s ease;
            }
            .mobile-only-menu-item button:hover {
                background-color: var(--card-bg-dark);
                transform: none;
            }
            /* Adjust payment button group in modal for mobile */
            .modal-content .btn-group {
                flex-direction: column;
                gap: 10px;
            }
            .modal-content .btn-group button {
                padding: 12px;
                font-size: 1em;
            }
            .how-to-topup-list li {
                flex-direction: column;
                text-align: center;
                align-items: center;
            }
            .how-to-topup-list li .step-number {
                margin-bottom: 10px;
            }
            .how-to-topup-list li .step-content h4 {
                text-align: center;
            }
            .how-to-topup-list li .step-content p {
                text-align: center;
            }
            /* Adjust funny toggles for mobile */
            .theme-switch-wrapper {
                top: 10px; /* Even smaller top spacing */
                right: 10px; /* Even smaller right spacing */
            }
        }

        /* Specific breakpoint for 561dp and below */
        @media (max-width: 561px) {
            .theme-switch-wrapper {
                top: 10px; /* Consistent with 768px for now, can be fine-tuned */
                right: 10px;
            }
            .theme-switch {
                height: 30px;
                width: 54px;
                border-radius: 30px;
                border-width: 1.5px;
            }
            .theme-switch::after {
                width: 22px;
                height: 22px;
                top: 4px;
                left: 4px;
            }
            body.light-mode .theme-switch::after {
                transform: translateX(28px);
            }
            .contact-button {
                width: 100%; /* Make contact buttons full width on very small screens */
            }
        }

        /* Ensure smooth transitions for specific elements that might not be caught by global * */
        .game-selection img,
        .product-item,
        .payment-option,
        button {
            transition-property: all;
            transition-duration: 0.4s;
            transition-timing-function: ease-in-out;
        }
    </style>
</head>
<body class="login-body"> <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-icon-container">
            <div class="loading-icon"></div>
        </div>
    </div>

    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h2>LOGIN</h2>
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" id="username" placeholder="Username">
            </div>
            <div class="input-group">
                <i class="fas fa-lock"></i>
                <input type="password" id="password" placeholder="Password">
                <button type="button" class="password-toggle" id="togglePassword">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <div class="options-group">
                <label>
                    <input type="checkbox"> Remember me
                </label>
                <a href="#">Forgot password?</a>
            </div>
            <p id="loginError" class="error-message"></p>
            <button onclick="login()">LOGIN</button>
            <p class="register-link">Don't have an account? <a href="#">Register</a></p>
        </div>
    </div>


    <div id="mainContent" style="display: none;">
        <header class="header">
            <a href="#" class="logo">
                <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752530358/tiicc6g94vsmci47fwd8.jpg" alt="MLBB Logo">
                Kai Store Official
            </a>
            <div class="desktop-options">
                <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider round"></div>
                    </label>
                </div>
                <button onclick="showCustomerServiceModal()" style="background: none; border: none; color: var(--text-color-dark); font-size: 1.05em; font-weight: 600; margin-left: 20px; cursor: pointer; transition: color 0.3s ease;">
                    Customer Service
                </button>
            </div>
            <button class="nav-toggle" id="navToggle">
                <div class="hamburger">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </button>
            <nav class="navbar" id="navbarMenu">
                <ul>
                    <li><a href="#">Beranda</a></li>
                    <li><a href="#how-to-topup-section">Cara Top Up</a></li>
                    <li><a href="#">Promo</a></li>
                    <li class="mobile-only-menu-item">
                        <button id="toggleThemeBtnMobile">Dark/Light Mode</button>
                    </li>
                    <li class="mobile-only-menu-item">
                        <button onclick="showCustomerServiceModal()">Customer Service</button>
                    </li>
                </ul>
                <div class="cart-icon" onclick="showCartModal()">
                     <span class="cart-count" id="cartItemCount">0</span>
                </div>
            </nav>
        </header>

        <div class="container fade-in">
            <div class="main-content">
                <div class="card">
                    <h2>1. Pilih Game</h2>
                    <div class="game-selection">
                        <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752530358/tiicc6g94vsmci47fwd8.jpg" alt="Mobile Legends Logo" id="gameMLBB" class="selected" data-game="mlbb">
                        <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752530386/f5eaj7s4vu1un4s2z6ah.jpg" alt="Free Fire Logo" id="gameFF" data-game="freefire">
                    </div>
                </div>

                <div class="card">
                    <h2>2. Masukkan User ID</h2>
                    <div class="user-id-inputs">
                        <div class="input-group">
                            <label for="playerID">User ID</label>
                            <input type="text" id="playerID" placeholder="Contoh: 12345678">
                            <p id="playerIDError" class="input-error-message">User ID wajib diisi.</p>
                        </div>
                        <div class="input-group" id="serverIDGroup">
                            <label for="serverID">Server ID</label>
                            <input type="text" id="serverID" placeholder="Contoh: 1234">
                            <p id="serverIDError" class="input-error-message">Server ID wajib diisi untuk MLBB.</p>
                        </div>
                    </div>
                    <small style="color: #bbb; display: block; margin-top: -15px;">Untuk Mobile Legends, masukkan User ID dan Server ID Anda.</small>
                </div>

                <div class="card">
                    <h2>3. Pilih Nominal Top Up</h2>
                    <div id="productSelection" class="product-grid">
                        </div>
                </div>

                <div class="card">
                    <h2>4. Pilih Pembayaran</h2>
                    <div class="payment-options-grid">
                        <div class="payment-option" data-method="dana">
                            <img src="https://img1.pixhost.to/images/7217/622065851_uploaded_image.jpg" alt="Logo DANA">
                            <p>DANA</p>
                        </div>
                        <div class="payment-option" data-method="gopay">
                            <img src="https://img1.pixhost.to/images/7217/622065131_uploaded_image.jpg" alt="Logo GOPAY">
                            <p>GOPAY</p>
                        </div>
                        <div class="payment-option" data-method="shopepay">
                            <img src="https://img1.pixhost.to/images/7217/622065009_uploaded_image.jpg" alt="Logo ShopeePay">
                            <p>ShopeePay</p>
                        </div>
                        <div class="payment-option" data-method="ovo">
                            <img src="https://img1.pixhost.to/images/7217/622065154_uploaded_image.jpg" alt="Logo OVO"> <p>OVO</p>
                        </div>
                        <div class="payment-option" data-method="qris">
                            <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/v1721013444/qris_logo_dixyct.png" alt="Logo QRIS">
                            <p>QRIS</p>
                        </div>
                        <div class="payment-option" data-method="wdp">
                            <img src="https://img1.pixhost.to/images/7217/622065183_uploaded_image.jpg" alt="Logo WDP">
                            <p>WDP</p>
                        </div>
                        </div>
                </div>

                <div class="card">
                    <h2>5. Konfirmasi Pembelian</h2>
                    <button id="buyButton">Beli Sekarang</button>
                </div>
            </div>

            <div class="sidebar">
                <div class="card">
                    <h2>Ringkasan Pesanan</h2>
                    <div class="summary-item">
                        <span>Game:</span>
                        <span id="summaryGame">Belum Dipilih</span>
                    </div>
                    <div class="summary-item">
                        <span>User ID:</span>
                        <span id="summaryPlayerID">N/A</span>
                    </div>
                     <div class="summary-item" id="summaryServerIDRow" style="display: none;">
                        <span>Server ID:</span>
                        <span id="summaryServerID">N/A</span>
                    </div>
                    <div class="summary-item">
                        <span>Item:</span>
                        <span id="summaryItem">Belum Dipilih</span>
                    </div>
                    <div class="summary-item">
                        <span>Harga Awal:</span>
                        <span id="summaryOriginalPrice">Rp 0</span>
                    </div>
                     <div class="summary-item" id="summaryDiscountRow" style="display: none;">
                        <span>Diskon:</span>
                        <span id="summaryDiscount" style="color: #3cb371;">- Rp 0</span>
                    </div>
                    <div class="summary-total">
                        <span>Total Bayar:</span>
                        <span id="summaryTotal">Rp 0</span>
                    </div>

                    <div class="discount-section">
                        <h3>Punya Kode Diskon?</h3>
                        <div class="discount-input-group">
                            <input type="text" id="discountCodeInput" placeholder="Masukkan kode diskon">
                            <button onclick="applyDiscount()">Terapkan</button>
                        </div>
                        <p id="discountMessage" class="discount-message"></p>
                    </div>
                    <p style="font-size: 0.9em; color: #aaa; margin-top: 20px;">*Pastikan User ID Anda benar. Kesalahan User ID bukan tanggung jawab kami.</p>
                </div>

                <div class="card contact-card">
                    <h2>Butuh Bantuan?</h2>
                    <div class="cs-contact-method">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/1200px-WhatsApp.svg.png" alt="WhatsApp Icon">
                        <a href="https://wa.me/6287830580217" target="_blank">WhatsApp: 6287830580217</a>
                    </div>
                    <div class="cs-contact-method">
                         <img src="https://img.icons8.com/ios-filled/50/ffffff/instagram-new.png" alt="Instagram Icon" style="filter: invert(1);">
                        <a href="https://instagram.com/zuraaatt_12" target="_blank">Instagram: @zuraaatt_12</a>
                    </div>
                    <div class="cs-contact-method">
                        <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/v1721013444/email_icon_m181n5.png" alt="Email Icon" style="filter: invert(1);">
                        <a href="mailto:ytku4366@gmail.com" target="_blank">Email: ytku4366@gmail.com</a>
                    </div>
                    <p style="font-size: 0.9em; color: #ccc;">Hubungi kami jika ada kendala pembayaran atau pertanyaan lainnya.</p>
                </div>
            </div>
            </div>

        <div class="container how-to-topup-section" id="how-to-topup-section">
            <h2>Cara Top Up di Kai Store Official</h2>
            <ul class="how-to-topup-list">
                <li>
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>Login ke Akun Anda</h4>
                        <p>Masuk ke akun Kai Store Official Anda menggunakan Username dan Password.</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Akses Menu Top Up & Pilih Game</h4>
                        <p>Setelah login, navigasikan ke menu "Top Up". Pilih game yang ingin Anda isi, lalu masukkan User ID Anda. Untuk Mobile Legends, Server ID juga wajib diisi.</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Pilih Nominal Top Up</h4>
                        <p>Pilih jumlah diamond/item yang Anda inginkan. Anda juga bisa menggunakan kode diskon jika tersedia.</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>Pilih Metode Pembayaran</h4>
                        <p>Pilih metode pembayaran yang paling nyaman bagi Anda (DANA, OVO, GoPay, ShopeePay, QRIS, WDP, dll.).</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h4>Lakukan Transfer & Unggah Bukti</h4>
                        <p>Lakukan transfer sesuai total pembayaran yang tertera. **Unggah bukti transfer Anda melalui formulir yang disediakan di modal konfirmasi.** Pastikan gambar jelas dan mencakup semua detail penting. Pratinjau gambar akan langsung muncul.</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h4>Konfirmasi Pembayaran</h4>
                        <p>Klik tombol 'Sudah Bayar & Konfirmasi' untuk mengirim pesanan Anda. Sistem akan memprosesnya.</p>
                    </div>
                </li>
                 <li>
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <h4>Verifikasi & Konfirmasi WhatsApp</h4>
                        <p>Tim kami akan memverifikasi pembayaran Anda. Untuk mempercepat proses, Anda dapat menekan tombol 'Kirim Pesanan Via WhatsApp' setelah konfirmasi.</p>
                    </div>
                </li>
                <li>
                    <div class="step-number">8</div>
                    <div class="step-content">
                        <h4>Selesai!</h4>
                        <p>Setelah verifikasi berhasil, diamond/item akan segera masuk ke akun game Anda. Selamat bermain dan terima kasih telah top up di Kai Store Official!</p>
                    </div>
                </li>
            </ul>
        </div>

        <div class="contact-button-section">
            <h2>Click the Button</h2>
            <div class="contact-button-group">
                <a href="https://instagram.com/zuraaatt_12" target="_blank" class="contact-button instagram-button">
                    <div class="icon-container"><i class="fab fa-instagram"></i></div>
                    <span>Instagram</span>
                </a>
                <a href="https://wa.me/6287830580217" target="_blank" class="contact-button whatsapp-button">
                    <div class="icon-container"><i class="fab fa-whatsapp"></i></div>
                    <span>WhatsApp</span>
                </a>
                <a href="mailto:ytku4366@gmail.com" target="_blank" class="contact-button email-button">
                    <div class="icon-container"><i class="fas fa-envelope"></i></div>
                    <span>Email</span>
                </a>
            </div>
        </div>

        <footer class="footer">
            <p>&copy; 2025 Kai Store Official. All rights reserved.</p>
            <p>Didukung oleh semangat gamers Indonesia.</p>
        </footer>
    </div>

    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('paymentModal')">&times;</span>
            <h3>Konfirmasi Pembayaran</h3>
            <p>Anda akan membeli <strong id="modalItem"></strong> untuk User ID <strong id="modalPlayerID"></strong>.</p>
            <p id="modalServerIDRow" style="display: none;">Server ID: <strong id="modalServerID"></strong></p>
            <p>Harga Awal: <strong id="modalOriginalPrice"></strong></p>
            <p id="modalDiscountRow" style="display: none;">Diskon: <strong id="modalDiscount" style="color: #3cb371;"></strong></p>
            <p>Total yang harus dibayar: <strong id="modalTotalPrice"></strong></p>
            <p>Metode pembayaran: <strong id="modalPaymentMethod"></strong></p>

            <div id="paymentDetails">
                </div>

            <div class="upload-proof-section" style="margin-top: 25px; text-align: left;">
                <label for="paymentProof" style="font-size: 1.1em; margin-bottom: 12px; font-weight: 700;">Upload Bukti Pembayaran <span style="color: var(--accent-color-light-purple); font-size: 0.9em;">*Wajib</span></label>
                <input type="file" id="paymentProof" accept="image/png, image/jpeg, image/jpg" required>
                <p id="proofUploadError" class="input-error-message">Mohon upload bukti pembayaran Anda.</p>
                <div class="image-preview-container" id="paymentProofPreviewContainer" style="display: none;">
                    <img id="paymentProofPreview" src="" alt="Pratinjau Bukti Pembayaran" style="margin-top: 10px;">
                    <p id="paymentProofFileName"></p>
                </div>
            </div>

            <p style="margin-top: 25px; font-size: 0.95em; color: #ccc;">Segera lakukan pembayaran. Setelah pembayaran berhasil, top up akan diproses secara otomatis.</p>
            <p style="font-weight: bold; color: #e74c3c; font-size: 1em;">PENTING: Pastikan Anda telah melakukan pembayaran sebelum mengklik 'Sudah Bayar'.</p>

            <div class="btn-group">
                <button onclick="handlePaymentComplete()">Sudah Bayar & Konfirmasi</button>
                <button class="whatsapp-send" onclick="sendWhatsAppMessage()">Kirim Pesanan Via WhatsApp</button>
                <button class="cancel" onclick="closeModal('paymentModal')">Batal</button>
            </div>
        </div>
    </div>

    <div id="csModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('csModal')">&times;</span>
            <h3>Hubungi Customer Service</h3>
            <p>Kami siap membantu Anda!</p>
            <div class="cs-contact-method" style="justify-content: center;">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/1200px-WhatsApp.svg.png" alt="WhatsApp Icon">
                <a href="https://wa.me/6287830580217" target="_blank">WhatsApp: 6287830580217 (Admin Kai Store)</a>
            </div>
            <div class="cs-contact-method" style="justify-content: center;">
                 <img src="https://img.icons8.com/ios-filled/50/ffffff/instagram-new.png" alt="Instagram Icon" style="filter: invert(1);">
                <a href="https://instagram.com/zuraaatt_12" target="_blank">Instagram: @zuraaatt_12</a>
            </div>
             <div class="cs-contact-method" style="justify-content: center;">
                <img src="https://res.cloudinary.com/dtjjgiitl/image/upload/v1721013444/email_icon_m181n5.png" alt="Email Icon" style="filter: invert(1);">
                <a href="mailto:ytku4366@gmail.com" target="_blank">Email: ytku4366@gmail.com</a>
            </div>
            <p style="margin-top: 25px;">**Opsi Keluhan:** Jika Anda memiliki keluhan terkait transaksi atau layanan kami, mohon sertakan detail transaksi (User ID, jumlah top-up, metode pembayaran, dan bukti pembayaran) saat menghubungi WhatsApp CS kami.</p>
             <div class="btn-group">
                <button class="cancel" onclick="closeModal('csModal')">Tutup</button>
            </div>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content cart-modal-content">
            <span class="close-button" onclick="closeModal('cartModal')">&times;</span>
            <h3>Keranjang Belanja</h3>
            <div id="cartItemsContainer">
                </div>
            <p id="emptyCartMessage" class="empty-cart-message" style="display: none;">Keranjang Anda kosong.</p>
            <div class="cart-total">
                <span>Total Keranjang:</span>
                <span id="cartTotalPrice">Rp 0</span>
            </div>
            <div class="btn-group">
                <button onclick="checkoutCart()">Lanjutkan ke Pembayaran</button>
                <button class="cancel" onclick="closeModal('cartModal')">Lanjutkan Belanja</button>
            </div>
        </div>
    </div>

    <script>
        // --- Data Produk ---
        const products = {
            mlbb: [
                { id: 'mlbb-3', name: '3 Diamond MLBB', price: 1900 },
                { id: 'mlbb-5', name: '5 Diamond MLBB', price: 2600 },
                { id: 'mlbb-10', name: '10 Diamond MLBB', price: 4900 },
                { id: 'mlbb-11', name: '11 Diamond MLBB', price: 5000 },
                { id: 'mlbb-12', name: '12 Diamond MLBB', price: 5100 },
                { id: 'mlbb-14', name: '14 Diamond MLBB', price: 6200 },
                { id: 'mlbb-15', name: '15 Diamond MLBB', price: 6700 },
                { id: 'mlbb-18', name: '18 Diamond MLBB', price: 7000 },
                { id: 'mlbb-19', name: '19 Diamond MLBB', price: 7500 },
                { id: 'mlbb-20', name: '20 Diamond MLBB', price: 8100 },
                { id: 'mlbb-22', name: '22 Diamond MLBB', price: 8300 },
                { id: 'mlbb-28', name: '28 Diamond MLBB', price: 10000 },
                { id: 'mlbb-30', name: '30 Diamond MLBB', price: 10300 },
                { id: 'mlbb-33', name: '33 Diamond MLBB', price: 11300 },
                { id: 'mlbb-34', name: '34 Diamond MLBB', price: 11800 },
                { id: 'mlbb-36', name: '36 Diamond MLBB', price: 12000 },
                { id: 'mlbb-42', name: '42 Diamond MLBB', price: 14200 },
                { id: 'mlbb-44', name: '44 Diamond MLBB', price: 14000 },
                { id: 'mlbb-45', name: '45 Diamond MLBB', price: 14600 },
                { id: 'mlbb-46', name: '46 Diamond MLBB', price: 14700 },
                { id: 'mlbb-50', name: '50 Diamond MLBB', price: 15700 },
                { id: 'mlbb-54', name: '54 Diamond MLBB', price: 16500 },
                { id: 'mlbb-56', name: '56 Diamond MLBB', price: 17000 },
                { id: 'mlbb-59', name: '59 Diamond MLBB', price: 17800 },
                { id: 'mlbb-65', name: '65 Diamond MLBB', price: 19500 },
                { id: 'mlbb-70', name: '70 Diamond MLBB', price: 20800 },
                { id: 'mlbb-75', name: '75 Diamond MLBB', price: 22300 },
                { id: 'mlbb-80', name: '80 Diamond MLBB', price: 23300 },
                { id: 'mlbb-85', name: '85 Diamond MLBB', price: 24500 },
                { id: 'mlbb-90', name: '90 Diamond MLBB', price: 25600 },
                { id: 'mlbb-100', name: '100 Diamond MLBB', price: 28500 },
                { id: 'mlbb-110', name: '110 Diamond MLBB', price: 30000 },
                { id: 'mlbb-129', name: '129 Diamond MLBB', price: 35800 },
                { id: 'mlbb-140', name: '140 Diamond MLBB', price: 39000 },
                { id: 'mlbb-145', name: '145 Diamond MLBB', price: 40000 },
                { id: 'mlbb-150', name: '150 Diamond MLBB', price: 41500 },
                { id: 'mlbb-168', name: '168 Diamond MLBB', price: 46000 },
                { id: 'mlbb-170', name: '170 Diamond MLBB', price: 46500 },
                { id: 'mlbb-176', name: '176 Diamond MLBB', price: 46800 },
                { id: 'mlbb-182', name: '182 Diamond MLBB', price: 48500 },
                { id: 'mlbb-194', name: '194 Diamond MLBB', price: 52000 },
                { id: 'mlbb-200', name: '200 Diamond MLBB', price: 53900 },
                { id: 'mlbb-220', name: '220 Diamond MLBB', price: 59000 },
                { id: 'mlbb-225', name: '225 Diamond MLBB', price: 59900 },
                { id: 'mlbb-240', name: '240 Diamond MLBB', price: 63800 },
                { id: 'mlbb-250', name: '250 Diamond MLBB', price: 66700 },
                { id: 'mlbb-261', name: '261 Diamond MLBB', price: 69000 },
                { id: 'mlbb-276', name: '276 Diamond MLBB', price: 72900 },
                { id: 'mlbb-280', name: '280 Diamond MLBB', price: 73900 },
                { id: 'mlbb-296', name: '296 Diamond MLBB', price: 77900 },
                { id: 'mlbb-300', name: '300 Diamond MLBB', price: 78900 },
                { id: 'mlbb-340', name: '340 Diamond MLBB', price: 89200 },
                { id: 'mlbb-355', name: '355 Diamond MLBB', price: 93300 },
                { id: 'mlbb-366', name: '366 Diamond MLBB', price: 96500 },
                { id: 'mlbb-370', name: '370 Diamond MLBB', price: 98500 },
                { id: 'mlbb-380', name: '380 Diamond MLBB', price: 99500 },
                { id: 'mlbb-399', name: '399 Diamond MLBB', price: 105200 },
                { id: 'mlbb-415', name: '415 Diamond MLBB', price: 107500 },
                { id: 'mlbb-425', name: '425 Diamond MLBB', price: 110200 },
                { id: 'mlbb-440', name: '440 Diamond MLBB', price: 114500 },
                { id: 'mlbb-453', name: '453 Diamond MLBB', price: 117500 },
                { id: 'mlbb-460', name: '460 Diamond MLBB', price: 120500 },
                { id: 'mlbb-500', name: '500 Diamond MLBB', price: 130900 },
                { id: 'mlbb-516', name: '516 Diamond MLBB', price: 134900 },
                { id: 'mlbb-530', name: '530 Diamond MLBB', price: 137500 },
                { id: 'mlbb-550', name: '550 Diamond MLBB', price: 143500 },
                { id: 'mlbb-570', name: '570 Diamond MLBB', price: 148500 },
                { id: 'mlbb-600', name: '600 Diamond MLBB', price: 155300 },
                { id: 'mlbb-635', name: '635 Diamond MLBB', price: 160900 },
                { id: 'mlbb-666', name: '666 Diamond MLBB', price: 168900 },
                { id: 'mlbb-702', name: '702 Diamond MLBB', price: 181500 },
                { id: 'mlbb-740', name: '740 Diamond MLBB', price: 187500 },
                { id: 'mlbb-790', name: '790 Diamond MLBB', price: 202200 },
                { id: 'mlbb-850', name: '850 Diamond MLBB', price: 217500 },
                { id: 'mlbb-882', name: '882 Diamond MLBB', price: 223200 },
                { id: 'mlbb-870', name: '870 Diamond MLBB', price: 223600 },
                { id: 'mlbb-938', name: '938 Diamond MLBB', price: 234500 },
                { id: 'mlbb-963', name: '963 Diamond MLBB', price: 238500 },
                { id: 'mlbb-975', name: '975 Diamond MLBB', price: 242400 },
                { id: 'mlbb-wdp-220', name: 'WDP 220 Diamond MLBB', price: 26800 },
                { id: 'mlbb-starlight-po', name: 'Starlight Member PO', price: 34000 },
                { id: 'mlbb-starlight-fast', name: 'Starlight Member Cepat', price: 82000 }
            ],
            freefire: [
                { id: 'ff-5', name: '5 Diamond FF', price: 1250 },
                { id: 'ff-12', name: '12 Diamond FF', price: 2300 },
                { id: 'ff-50', name: '50 Diamond FF', price: 8000 },
                { id: 'ff-70', name: '70 Diamond FF', price: 10000 },
                { id: 'ff-140', name: '140 Diamond FF', price: 20000 },
                { id: 'ff-355', name: '355 Diamond FF', price: 49600 },
                { id: 'ff-720', name: '720 Diamond FF', price: 99100 },
                { id: 'ff-1450', name: '1450 Diamond FF', price: 199400 },
                { id: 'ff-2180', name: '2180 Diamond FF', price: 295650 },
                { id: 'ff-3640', name: '3640 Diamond FF', price: 495900 },
                { id: 'ff-7290', name: '7290 Diamond FF', price: 995000 }
            ]
        };

        const paymentAccounts = {
            dana: { name: 'DANA', number: '089684076072', icon: 'https://img1.pixhost.to/images/7217/622065851_uploaded_image.jpg' },
            gopay: { name: 'GOPAY', number: '089684076072', icon: 'https://img1.pixhost.to/images/7217/622065131_uploaded_image.jpg' },
            shopepay: { name: 'ShopeePay', number: '089684076072', icon: 'https://img1.pixhost.to/images/7217/622065009_uploaded_image.jpg' },
            ovo: { name: 'OVO', number: '089684076072', icon: 'https://img1.pixhost.to/images/7217/622065154_uploaded_image.jpg' },
            qris: { name: 'QRIS', qrisImage: 'https://img1.pixhost.to/images/7213/621996688_uploaded_image.jpg', icon: 'https://res.cloudinary.com/dtjjgiitl/image/upload/v1721013444/qris_logo_dixyct.png' },
            wdp: { name: 'WDP', number: '089684076072 (WDP)', icon: 'https://img1.pixhost.to/images/7217/622065183_uploaded_image.jpg'}
        };

        // --- State Variables ---
        let selectedGame = 'mlbb';
        let selectedProduct = null;
        let selectedPaymentMethod = null;
        let appliedDiscountCode = null;
        let cart = [];
        const csPhoneNumber = '6287830580217';
        const csEmail = 'ytku4366@gmail.com';
        const instagramHandle = 'zuraaatt_12'; // Updated Instagram handle

        // --- DOM Elements ---
        const loadingOverlay = document.getElementById('loadingOverlay');
        const loginPage = document.getElementById('loginPage');
        const mainContent = document.getElementById('mainContent');

        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginError = document.getElementById('loginError');
        const togglePasswordBtn = document.getElementById('togglePassword');

        const gameMLBB = document.getElementById('gameMLBB');
        const gameFF = document.getElementById('gameFF');
        const playerIDInput = document.getElementById('playerID');
        const serverIDInput = document.getElementById('serverID');
        const serverIDGroup = document.getElementById('serverIDGroup');
        const playerIDError = document.getElementById('playerIDError');
        const serverIDError = document.getElementById('serverIDError');

        const productSelectionDiv = document.getElementById('productSelection');
        const paymentOptions = document.querySelectorAll('.payment-option');
        const buyButton = document.getElementById('buyButton');

        const summaryGame = document.getElementById('summaryGame');
        const summaryPlayerID = document.getElementById('summaryPlayerID');
        const summaryServerID = document.getElementById('summaryServerID');
        const summaryServerIDRow = document.getElementById('summaryServerIDRow');

        const summaryItem = document.getElementById('summaryItem');
        const summaryOriginalPrice = document.getElementById('summaryOriginalPrice');
        const summaryDiscount = document.getElementById('summaryDiscount');
        const summaryDiscountRow = document.getElementById('summaryDiscountRow');
        const summaryTotal = document.getElementById('summaryTotal');

        const discountCodeInput = document.getElementById('discountCodeInput');
        const discountMessage = document.getElementById('discountMessage');

        const paymentModal = document.getElementById('paymentModal');
        const modalItem = document.getElementById('modalItem');
        const modalPlayerID = document.getElementById('modalPlayerID');
        const modalServerID = document.getElementById('modalServerID');
        const modalServerIDRow = document.getElementById('modalServerIDRow');

        const modalOriginalPrice = document.getElementById('modalOriginalPrice');
        const modalDiscount = document.getElementById('modalDiscount');
        const modalDiscountRow = document.getElementById('modalDiscountRow');
        const modalTotalPrice = document.getElementById('modalTotalPrice');
        const modalPaymentMethod = document.getElementById('modalPaymentMethod');
        const paymentDetails = document.getElementById('paymentDetails');
        const paymentProofInput = document.getElementById('paymentProof');
        const proofUploadError = document.getElementById('proofUploadError');
        const paymentProofPreview = document.getElementById('paymentProofPreview');
        const paymentProofPreviewContainer = document.getElementById('paymentProofPreviewContainer');
        const paymentProofFileName = document.getElementById('paymentProofFileName');

        const csModal = document.getElementById('csModal');
        const cartModal = document.getElementById('cartModal');
        const cartItemsContainer = document.getElementById('cartItemsContainer');
        const cartTotalPrice = document.getElementById('cartTotalPrice');
        const emptyCartMessage = document.getElementById('emptyCartMessage');
        const cartItemCount = document.getElementById('cartItemCount');

        const themeToggleCheckbox = document.getElementById("checkbox"); // Funny toggle checkbox
        const toggleThemeBtnMobile = document.getElementById('toggleThemeBtnMobile'); // Mobile theme button
        const navToggle = document.getElementById('navToggle');
        const navbarMenu = document.getElementById('navbarMenu');
        const desktopDots = document.querySelector('.desktop-dots'); // Desktop three dots menu (now unused for theme toggle)

        // Initial setup on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            // Hide loading overlay after initial loading screen
            const initialLoadingDuration = 1500; // 1.5 seconds
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                if (sessionStorage.getItem('loggedIn') === 'true') {
                     mainContent.classList.add('fade-in');
                }
            }, initialLoadingDuration);

            // Check login status (for initial load)
            if (sessionStorage.getItem('loggedIn') !== 'true') {
                loginPage.style.display = 'flex';
                mainContent.style.display = 'none';
                document.body.classList.add('login-body');
            } else {
                loginPage.style.display = 'none';
                mainContent.style.display = 'block';
                document.body.classList.remove('login-body');
                loadProducts(selectedGame);
                updateServerIDVisibility();
                updateSummary();
            }

            // Load dark mode preference from localStorage for funny toggle
            const savedTheme = localStorage.getItem("theme");
            if (savedTheme === "light") {
                document.body.classList.add("light-mode");
                themeToggleCheckbox.checked = true;
            } else {
                // Default to dark if no preference or preference is 'dark'
                document.body.classList.remove("light-mode");
                themeToggleCheckbox.checked = false;
            }

            // Update CS Phone Numbers and Email in HTML
            document.querySelectorAll('.cs-contact-method a').forEach(link => {
                if (link.href.includes('wa.me')) {
                    link.href = `https://wa.me/${csPhoneNumber}`;
                    if (link.textContent.includes('62895418378663')) {
                        link.textContent = `WhatsApp: ${csPhoneNumber}`;
                    }
                } else if (link.href.includes('mailto:')) {
                    link.href = `mailto:${csEmail}`;
                    link.textContent = `Email: ${csEmail}`;
                } else if (link.href.includes('instagram.com')) {
                    link.href = `https://instagram.com/${instagramHandle}`;
                    link.textContent = `Instagram: @${instagramHandle}`;
                }
            });

            // If directly on main content, ensure data is loaded
            if (mainContent.style.display === 'block') {
                loadProducts(selectedGame);
                updateServerIDVisibility();
                updateSummary();
            }
        });


        // --- Helper Functions ---
        function formatRupiah(number) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(number);
        }

        function calculateDiscountAmount(originalPrice) {
            if (!appliedDiscountCode || !originalPrice) {
                return 0;
            }
            if (appliedDiscountCode === 'ZENNA GANTENG') {
                if (originalPrice < 100000) {
                    return originalPrice * 0.50; // 50% for under 100k
                } else {
                    return originalPrice * 0.25; // 25% for over 100k
                }
            }
            return 0;
        }

        function updateSummary() {
            summaryGame.textContent = selectedGame === 'mlbb' ? 'Mobile Legends' : 'Free Fire';
            summaryPlayerID.textContent = playerIDInput.value || 'N/A';

            if (selectedGame === 'mlbb') {
                summaryServerID.textContent = serverIDInput.value || 'N/A';
                summaryServerIDRow.style.display = 'flex';
            } else {
                summaryServerID.textContent = 'N/A';
                summaryServerIDRow.style.display = 'none';
            }

            let originalPrice = 0;
            let discountAmount = 0;
            let finalPrice = 0;

            if (selectedProduct) {
                summaryItem.textContent = selectedProduct.name;
                originalPrice = selectedProduct.price;
                summaryOriginalPrice.textContent = formatRupiah(originalPrice);

                discountAmount = calculateDiscountAmount(originalPrice);
                finalPrice = originalPrice - discountAmount;

                if (discountAmount > 0) {
                    summaryDiscount.textContent = `- ${formatRupiah(discountAmount)}`;
                    summaryDiscountRow.style.display = 'flex';
                } else {
                    summaryDiscountRow.style.display = 'none';
                }
            } else {
                summaryItem.textContent = 'Belum Dipilih';
                summaryOriginalPrice.textContent = formatRupiah(0);
                summaryDiscountRow.style.display = 'none';
            }
            summaryTotal.textContent = formatRupiah(finalPrice);
        }

        function updateServerIDVisibility() {
            if (selectedGame === 'mlbb') {
                serverIDGroup.style.display = 'block';
                serverIDInput.setAttribute('required', 'required');
            } else {
                serverIDGroup.style.display = 'none';
                serverIDInput.removeAttribute('required');
                serverIDInput.value = '';
                serverIDError.classList.remove('active');
            }
        }

        function loadProducts(game) {
            productSelectionDiv.innerHTML = '';
            const gameProducts = products[game];
            const mlDiamondIcon = 'https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752530358/tiicc6g94vsmci47fwd8.jpg';
            const ffDiamondIcon = 'https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752530386/f5eaj7s4vu1un4s2z6ah.jpg';
            const starlightIcon = 'https://res.cloudinary.com/dtjjgiitl/image/upload/q_auto:good,f_auto,fl_progressive/v1752533111/wlsspmykodwqbenxtrlq.jpg';
            const wdpIcon = paymentAccounts.wdp.icon;

            // Ensure products array for the selected game exists and is not empty
            if (!gameProducts || gameProducts.length === 0) {
                productSelectionDiv.innerHTML = `<p style="text-align: center; color: var(--text-color-dark);">Produk untuk game ini belum tersedia.</p>`;
                return;
            }

            gameProducts.forEach(product => {
                const productItem = document.createElement('div');
                productItem.classList.add('product-item');
                productItem.dataset.id = product.id;
                productItem.dataset.price = product.price;
                productItem.dataset.name = product.name;

                let displayValue = product.name;
                let productIconHtml = '';

                if (game === 'mlbb') {
                    if (product.id.includes('wdp')) {
                        productIconHtml = `<img src="${wdpIcon}" alt="WDP" class="diamond-icon">`;
                        displayValue = "WDP " + product.name.match(/(\d+)/)[1] + " DM";
                    } else if (product.id.includes('starlight')) {
                        productIconHtml = `<img src="${starlightIcon}" alt="Starlight" class="diamond-icon">`;
                        displayValue = product.name.replace('Starlight Member ', '');
                    } else {
                        productIconHtml = `<img src="${mlDiamondIcon}" alt="Diamond ML" class="diamond-icon">`;
                        displayValue = product.name.match(/(\d+)\s+Diamond/)[1];
                    }
                } else if (game === 'freefire') {
                    productIconHtml = `<img src="${ffDiamondIcon}" alt="Diamond FF" class="diamond-icon">`;
                    displayValue = product.name.match(/(\d+)\s+Diamond/)[1];
                }

                productItem.innerHTML = `
                    <p>${productIconHtml}${displayValue}</p>
                    <p class="price">${formatRupiah(product.price)}</p>
                `;
                productItem.addEventListener('click', () => {
                    document.querySelectorAll('.product-item').forEach(item => item.classList.remove('selected'));
                    productItem.classList.add('selected');
                    selectedProduct = product;
                    updateSummary();
                });
                productSelectionDiv.appendChild(productItem);
            });
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // --- Event Listeners ---
        gameMLBB.addEventListener('click', () => {
            gameFF.classList.remove('selected');
            gameMLBB.classList.add('selected');
            selectedGame = 'mlbb';
            selectedProduct = null;
            appliedDiscountCode = null;
            discountCodeInput.value = '';
            discountMessage.textContent = '';
            
            updateServerIDVisibility();
            updateSummary();
            playerIDError.classList.remove('active');
            serverIDError.classList.remove('active');
            loadProducts(selectedGame);
        });

        gameFF.addEventListener('click', () => {
            gameMLBB.classList.remove('selected');
            gameFF.classList.add('selected');
            selectedGame = 'freefire';
            selectedProduct = null;
            appliedDiscountCode = null;
            discountCodeInput.value = '';
            discountMessage.textContent = '';

            updateServerIDVisibility();
            updateSummary();
            playerIDError.classList.remove('active');
            serverIDError.classList.remove('active');
            loadProducts(selectedGame);
        });

        playerIDInput.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
            playerIDError.classList.remove('active');
            updateSummary();
        });
        serverIDInput.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
            serverIDError.classList.remove('active');
            updateSummary();
        });

        paymentOptions.forEach(option => {
            option.addEventListener('click', () => {
                paymentOptions.forEach(item => item.classList.remove('selected'));
                option.classList.add('selected');
                selectedPaymentMethod = option.dataset.method;
            });
        });

        buyButton.addEventListener('click', () => {
            let isValid = true;

            if (!playerIDInput.value.trim()) {
                playerIDError.classList.add('active');
                isValid = false;
            } else {
                playerIDError.classList.remove('active');
            }

            if (selectedGame === 'mlbb' && !serverIDInput.value.trim()) {
                serverIDError.classList.add('active');
                isValid = false;
            } else if (selectedGame === 'mlbb') {
                serverIDError.classList.remove('active');
            }

            if (!selectedProduct) {
                alert('Mohon pilih nominal top up.');
                isValid = false;
            }
            if (!selectedPaymentMethod) {
                alert('Mohon pilih metode pembayaran.');
                isValid = false;
            }

            if (!isValid) {
                return;
            }

            modalItem.textContent = selectedProduct.name;
            modalPlayerID.textContent = playerIDInput.value;
            modalOriginalPrice.textContent = formatRupiah(selectedProduct.price);

            if (selectedGame === 'mlbb') {
                modalServerID.textContent = serverIDInput.value;
                modalServerIDRow.style.display = 'block';
            } else {
                modalServerIDRow.style.display = 'none';
            }

            let finalPrice = selectedProduct.price - calculateDiscountAmount(selectedProduct.price);
            modalTotalPrice.textContent = formatRupiah(finalPrice);
            modalPaymentMethod.textContent = paymentAccounts[selectedPaymentMethod].name;

            if (calculateDiscountAmount(selectedProduct.price) > 0) {
                modalDiscount.textContent = `- ${formatRupiah(calculateDiscountAmount(selectedProduct.price))}`;
                modalDiscountRow.style.display = 'block';
            } else {
                modalDiscountRow.style.display = 'none';
            }

            paymentDetails.innerHTML = '';
            const paymentInfo = paymentAccounts[selectedPaymentMethod];
            if (paymentInfo.number) {
                paymentDetails.innerHTML = `
                    <p style="color: var(--text-color-dark);">Transfer ke ${paymentInfo.name}: <strong style="color: var(--accent-color-light-purple);">${paymentInfo.number}</strong></p>
                    <p style="color: var(--text-color-dark);">(An. Kai Store Official)</p>
                `;
            } else if (paymentInfo.qrisImage) {
                paymentDetails.innerHTML = `
                    <p style="color: var(--text-color-dark);">Scan QRIS di bawah ini:</p>
                    <div class="qris-code">
                        <img src="${paymentInfo.qrisImage}" alt="QRIS Code">
                    </div>
                `;
            }
            // Reset file input and preview when opening modal
            paymentProofInput.value = '';
            proofUploadError.classList.remove('active');
            paymentProofPreviewContainer.style.display = 'none';
            paymentProofPreview.src = '';
            paymentProofFileName.textContent = '';

            openModal('paymentModal');
        });

        // Live preview for payment proof
        paymentProofInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    paymentProofPreview.src = e.target.result;
                    paymentProofFileName.textContent = paymentProofInput.files[0].name;
                    paymentProofPreviewContainer.style.display = 'block';
                };
                reader.readAsDataURL(this.files[0]);
                proofUploadError.classList.remove('active');
            } else {
                paymentProofPreviewContainer.style.display = 'none';
                paymentProofPreview.src = '';
                paymentProofFileName.textContent = '';
            }
        });

        // Theme Toggle (Desktop & Mobile)
        themeToggleCheckbox.addEventListener("change", function () {
            document.body.classList.add('transition-animate');
            if (this.checked) {
                localStorage.setItem("theme", "light");
                document.body.classList.add("light-mode");
            } else {
                localStorage.setItem("theme", "dark");
                document.body.classList.remove("light-mode");
            }
            setTimeout(() => {
                document.body.classList.remove('transition-animate');
            }, 600);
        });

        // Mobile Nav Toggle
        navToggle.addEventListener('click', () => {
            navbarMenu.classList.toggle('active');
            navToggle.querySelector('.hamburger').classList.toggle('open');
        });

        // Close dropdown/mobile nav if clicked outside
        document.addEventListener('click', (event) => {
            // Close desktop dropdown
            if (desktopDropdown && desktopDropdown.classList.contains('active') && !desktopDropdown.contains(event.target) && !event.target.closest('.desktop-options')) {
                desktopDropdown.classList.remove('active');
            }
            // Close mobile navigation menu
            if (navbarMenu.classList.contains('active') && !navbarMenu.contains(event.target) && !navToggle.contains(event.target) && !event.target.closest('.mobile-only-menu-item')) {
                navbarMenu.classList.remove('active');
                if (navToggle.querySelector('.hamburger')) {
                    navToggle.querySelector('.hamburger').classList.remove('open');
                }
            }
        });

        // --- Discount Code Functions ---
        function applyDiscount() {
            const code = discountCodeInput.value.toUpperCase().trim();
            if (code === 'ZENNA GANTENG') {
                if (selectedProduct) {
                    appliedDiscountCode = code;
                    discountMessage.textContent = 'Kode diskon berhasil diterapkan!';
                    discountMessage.className = 'discount-message success';
                    updateSummary();
                } else {
                    discountMessage.textContent = 'Pilih nominal top up terlebih dahulu.';
                    discountMessage.className = 'discount-message error';
                }
            } else if (code === '') {
                appliedDiscountCode = null;
                discountMessage.textContent = '';
                updateSummary();
            }
            else {
                appliedDiscountCode = null;
                discountMessage.textContent = 'Kode diskon tidak valid.';
                discountMessage.className = 'discount-message error';
                updateSummary();
            }
        }

        // --- Modal & Payment Functions ---
        function handlePaymentComplete() {
            if (paymentProofInput.files.length === 0) {
                proofUploadError.classList.add('active');
                return;
            } else {
                proofUploadError.classList.remove('active');
            }

            closeModal('paymentModal');
            loadingOverlay.style.display = 'flex';

            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                alert('Pembayaran Anda telah dikonfirmasi dan akan segera diproses. Silakan lanjutkan ke WhatsApp untuk konfirmasi detail.');
            }, 3000);
        }

        function sendWhatsAppMessage() {
            if (!selectedProduct || !playerIDInput.value || !selectedPaymentMethod) {
                alert("Mohon lengkapi detail pesanan sebelum mengirim via WhatsApp.");
                return;
            }

            const gameName = selectedGame === 'mlbb' ? 'Mobile Legends' : 'Free Fire';
            const customerID = playerIDInput.value;
            const serverID = selectedGame === 'mlbb' ? `(${serverIDInput.value})` : '';
            const itemName = selectedProduct.name;
            const originalPrice = selectedProduct.price;
            const discountAmount = calculateDiscountAmount(originalPrice);
            const finalPrice = originalPrice - discountAmount;
            const paymentMethodName = paymentAccounts[selectedPaymentMethod].name;

            let message = `Halo Admin Kai Store Official, saya ingin konfirmasi pesanan top up:\n\n`;
            message += ` Game: ${gameName}\n`;
            message += ` User ID: ${customerID} ${serverID}\n`;
            message += ` Item: ${itemName}\n`;
            message += ` Harga Awal: ${formatRupiah(originalPrice)}\n`;
            if (discountAmount > 0) {
                message += ` Diskon: - ${formatRupiah(discountAmount)}\n`;
            }
            message += ` Total Bayar: ${formatRupiah(finalPrice)}\n`;
            message += ` Metode Pembayaran: ${paymentMethodName}\n\n`;
            message += `Mohon segera diproses. Terima kasih!`;

            const whatsappURL = `https://wa.me/${csPhoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        }

        function showCustomerServiceModal() {
            // Close desktop dropdown if it was active
            if (desktopDropdown) {
                desktopDropdown.classList.remove('active');
            }
            // Close mobile nav if active
            navbarMenu.classList.remove('active');
            if(navToggle.querySelector('.hamburger')) {
                navToggle.querySelector('.hamburger').classList.remove('open');
            }
            openModal('csModal');
        }

        // --- Login Functionality ---
        const correctUsername = "ZENNA";
        const correctPassword = "GANTENG";

        function login() {
            const username = usernameInput.value.trim().toUpperCase();
            const password = passwordInput.value.trim();

            if (username === correctUsername && password === correctPassword) {
                loginError.classList.remove('active');
                sessionStorage.setItem('loggedIn', 'true');
                
                loginPage.style.opacity = '0';
                loginPage.style.transform = 'scale(0.9)';
                loginPage.style.pointerEvents = 'none';

                setTimeout(() => {
                    loginPage.style.display = 'none';
                    mainContent.style.display = 'block';
                    mainContent.classList.add('fade-in');
                    document.body.classList.remove('login-body');
                    document.body.style.overflow = '';
                    loadProducts(selectedGame);
                    updateServerIDVisibility();
                    updateSummary();
                }, 500);
            } else {
                loginError.textContent = 'Username atau password salah.';
                loginError.classList.add('active');
            }
        }

        if (togglePasswordBtn) {
            togglePasswordBtn.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.querySelector('i').classList.toggle('fa-eye');
                this.querySelector('i').classList.toggle('fa-eye-slash');
            });
        }

        // --- Cart Functions (Basic, for demonstration) ---
        function updateCartCount() {
            cartItemCount.textContent = cart.length;
            cartItemCount.style.display = cart.length > 0 ? 'block' : 'none';
        }

        function showCartModal() {
            cartItemsContainer.innerHTML = '';
            let totalCartPrice = 0;

            if (cart.length === 0) {
                emptyCartMessage.style.display = 'block';
            } else {
                emptyCartMessage.style.display = 'none';
                cart.forEach(item => {
                    const cartItemDiv = document.createElement('div');
                    cartItemDiv.classList.add('cart-item');
                    const itemPrice = item.price - calculateDiscountAmount(item.price);
                    totalCartPrice += itemPrice;
                    cartItemDiv.innerHTML = `
                        <div class="item-details">
                            <p><strong>${item.name}</strong></p>
                            <p>Untuk ID: ${item.playerID}</p>
                            <p>Metode Bayar: ${paymentAccounts[item.method].name}</p>
                        </div>
                        <span class="item-price">${formatRupiah(itemPrice)}</span>
                    `;
                    cartItemsContainer.appendChild(cartItemDiv);
                });
            }
            cartTotalPrice.textContent = formatRupiah(totalCartPrice);
            openModal('cartModal');
        }

        function checkoutCart() {
            if (cart.length === 0) {
                alert("Keranjang Anda kosong, tidak ada yang bisa di-checkout.");
                return;
            }
            alert("Proses checkout untuk semua item di keranjang dimulai! (Ini adalah demo, fungsionalitas nyata memerlukan backend)");
            closeModal('cartModal');
            cart = [];
            updateCartCount();
        }
    </script>
</body>
</html>